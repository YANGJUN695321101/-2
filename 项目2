import re
import tkinter as tk
from tkinter import filedialog

class Application(tk.Frame):
    def __init__(self, master=None):
        super().__init__(master)
        self.master = master
        self.master.title("提取中文")
        self.pack()
        self.create_widgets()

    def create_widgets(self):
        self.file_button = tk.Button(self, text="打开文件", command=self.open_file)
        self.file_button.pack(side="top")

        self.text_label = tk.Label(self, text="请输入文本：")
        self.text_label.pack(side="top")

        self.text_entry = tk.Text(self, height=10)
        self.text_entry.pack(side="top")

        self.extract_button = tk.Button(self, text="提取中文", command=self.extract_chinese)
        self.extract_button.pack(side="left")

        self.save_button = tk.Button(self, text="保存为文本文件", command=self.save_file)
        self.save_button.pack(side="left")

    def open_file(self):
        file_path = filedialog.askopenfilename(initialdir="D:/DESK", title="打开文件", filetypes=[("Text Files", "*.txt")])
        if file_path:
            with open(file_path, 'r', encoding='utf-8') as f:
                self.text_entry.delete('1.0', 'end')
                self.text_entry.insert('1.0', f.read())

    def extract_chinese(self):
        text = self.text_entry.get("1.0", "end")
        pattern = re.compile(r'[\u4e00-\u9fa5]+')  # 只匹配中文字符
        matches = pattern.findall(text)
        self.chinese_text = '\n'.join(matches)

    def save_file(self):
        file_path = filedialog.asksaveasfilename(initialdir="D:/DESK", defaultextension=".txt", filetypes=[("Text Files", "*.txt")])
        if file_path:
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write(self.chinese_text)
            tk.messagebox.showinfo("文件保存", "文件已保存到{}".format(file_path))

root = tk.Tk()
app = Application(master=root)
app.mainloop()
